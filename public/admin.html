<!DOCTYPE html>
<html lang="es">
<head>
  <meta charset="UTF-8" />
  <title>RetroGamer · Admin</title>
  <meta name="viewport" content="width=device-width, initial-scale=1.0" />
  <link rel="stylesheet" href="https://fonts.googleapis.com/css2?family=Material+Symbols+Outlined:opsz,wght,FILL,GRAD@24,400,0,0"/>
  <link rel="stylesheet" href="/css/admin.css" />
</head>
<body>
  <div class="admin-page">
    <header class="admin-topbar">
      <div class="admin-topbar-left">
        <span class="admin-topbar-logo-main">RetroGamer</span>
        <span class="admin-topbar-logo-sub">ADMIN</span>
      </div>

      <nav class="admin-topbar-nav">
        <button
          type="button"
          class="admin-nav-link admin-nav-link-active"
          data-view="clientes"
        >
          <span class="material-symbols-outlined">groups</span>
          <span>Clientes</span>
        </button>

        <button
          type="button"
          class="admin-nav-link"
          data-view="articulos"
        >
          <span class="material-symbols-outlined">sports_esports</span>
          <span>Productos</span>
        </button>

        <button
          type="button"
          class="admin-nav-link"
          data-view="categorias"
        >
          <span class="material-symbols-outlined">category</span>
          <span>Categorías</span>
        </button>

        <button
          type="button"
          class="admin-nav-link"
          data-view="banners"
        >
          <span class="material-symbols-outlined">panorama</span>
          <span>Banners</span>
        </button>

        <button
          type="button"
          class="admin-nav-link"
          data-view="pedidos"
        >
          <span class="material-symbols-outlined">receipt_long</span>
          <span>Pedidos</span>
        </button>

        <button
          type="button"
          class="admin-nav-link"
          data-view="envios"
        >
          <span class="material-symbols-outlined">local_shipping</span>
          <span>Envíos</span>
        </button>
      </nav>

      <div class="admin-topbar-right">
        <a href="/" class="btn btn-outline" id="btnIrTienda" target="_blank" rel="noopener noreferrer">
          <span class="material-symbols-outlined">storefront</span>
          <span>Storefront</span>
        </a>

        <button id="btnLogout" class="btn-outline-danger">
          <span class="material-symbols-outlined">logout</span>
          <span>Cerrar sesión</span>
        </button>
      </div>
      
        
    </header>

    <main class="admin-main">
      <header class="admin-header">
        <h1>RetroGamer · <span id="adminTituloVista">Clientes</span></h1>
        <p class="admin-header-sub">
          Panel de administración de tu tienda RetroGamer.
        </p>
      </header>

      <section id="view-clientes" class="admin-view">
        <div class="layout">
          <section class="card">
            <div class="card-header">
              <h2 id="formTitulo">Nuevo cliente</h2>
              <span class="pill" id="modoEtiqueta">Modo creación</span>
            </div>
            <p class="subtext">Registra o edita clientes.</p>

            <form id="formCliente" autocomplete="off">
              <label for="telefono">Teléfono (10 dígitos)</label>
              <input type="text" id="telefono" maxlength="10" placeholder="Ej. 9612345678" />

              <label for="nombre">Nombre completo</label>
              <input type="text" id="nombre" placeholder="Nombre completo" />

              <label for="correo">Correo electrónico</label>
              <input type="email" id="correo" placeholder="correo@ejemplo.com" />

              <div class="field-row">
                <div>
                  <label for="password">Contraseña</label>
                  <input type="password" id="password" placeholder="Mínimo 8 caracteres" />
                </div>
                <div>
                  <label for="password2">Confirmar contraseña</label>
                  <input type="password" id="password2" placeholder="Repite la contraseña" />
                </div>
              </div>

              <div class="form-actions">
                <button type="submit" class="btn btn-primary">
                  <span class="material-symbols-outlined">save</span>
                  <span id="btnGuardarTexto">Guardar cliente</span>
                </button>
                <button type="button" class="btn btn-secondary" id="btnCancelar">
                  <span class="material-symbols-outlined">keyboard_return</span>
                  Cancelar
                </button>
              </div>
            </form>

            <div id="mensaje" class="status"></div>
          </section>

          <section class="card">
            <div class="card-header">
              <h2>Listado de clientes</h2>
            </div>

            <div class="list-header">
              <div class="search-box">
                <span class="material-symbols-outlined">search</span>
                <input
                  type="text"
                  id="buscador"
                  placeholder="Buscar por teléfono, nombre o correo."
                />
              </div>
              <div class="count-chip">
                Total: <span id="totalClientes">0</span>
              </div>
            </div>
            
            <div class="table-scroll">
            <table>
              <thead>
                <tr>
                  <th>Teléfono</th>
                  <th>Nombre</th>
                  <th>Correo</th>
                  <th>Registrado</th>
                  <th>Acciones</th>
                </tr>
              </thead>
              <tbody id="tbodyClientes"></tbody>
            </table>
            </div>

            <div id="estadoTabla" class="empty-state" style="display:none;">
              No se encontraron clientes. Agrega uno nuevo o ajusta el filtro de búsqueda.
            </div>
          </section>
        </div>
      </section>

      <!-- VISTA ARTÍCULOS -->
      <section id="view-articulos" class="admin-view hidden">
        <div class="layout">
          <!-- Formulario Artículo -->
          <section class="card">
            <div class="card-header">
              <h2 id="formArticuloTitulo">Nuevo producto</h2>
              <span class="pill" id="modoArticuloEtiqueta">Modo creación</span>
            </div>
            <p class="subtext">Registra o edita productos del catálogo.</p>

            <form id="formArticulo" autocomplete="off" enctype="multipart/form-data">
              <label for="artNombre">Nombre del producto</label>
              <input type="text" id="artNombre" placeholder="Ej. God of War (PS4)" />

              <label for="artDescripcion">Descripción</label>
              <textarea
                id="artDescripcion"
                rows="3"
                placeholder="Descripción breve del producto"
                style="width:100%; padding:8px 9px; border-radius:10px; border:1px solid var(--border); background:rgba(15,23,42,0.9); color:var(--text); font-size:0.85rem; margin-bottom:8px; resize: vertical;"
              ></textarea>

              <div class="field-row">
                <div>
                  <label for="artPrecio">Precio (MXN)</label>
                  <input type="number" step="0.01" id="artPrecio" placeholder="Ej. 799.00" />
                </div>
                <div>
                  <label for="artExistencia">Existencia</label>
                  <input type="number" id="artExistencia" placeholder="Ej. 10" />
                </div>
              </div>

              <div class="select-row">
                <div>
                  <label for="artCategoriaPadre">Categoría</label>
                  <select id="artCategoriaPadre">
                    <option value="">categoría</option>
                  </select>
                </div>
                <div>
                  <label for="artSubcategoria">Subcategoría (opcional)</label>
                  <select id="artSubcategoria" disabled>
                    <option value="">subcategoría</option>
                  </select>
                </div>
              </div>

              <label for="artImagen">Imagen del producto</label>
              <input type="file" id="artImagen" accept="image/*" />

              <div class="form-actions">
                <button type="submit" class="btn btn-primary">
                  <span class="material-symbols-outlined">save</span>
                  <span id="btnArticuloGuardarTexto">Guardar producto</span>
                </button>
                <button type="button" class="btn btn-secondary" id="btnArticuloCancelar">
                  <span class="material-symbols-outlined">keyboard_return</span>
                  Cancelar
                </button>
              </div>
            </form>

            <div id="mensajeArticulo" class="status"></div>
          </section>

          <!-- Tabla Artículos -->
          <section class="card">
            <div class="card-header">
              <h2>Listado de productos</h2>
            </div>

            <div class="list-header">
              <div class="search-box">
                <span class="material-symbols-outlined">search</span>
                <input
                  type="text"
                  id="buscadorArticulos"
                  placeholder="Buscar por código o nombre."
                />
              </div>
              <div class="count-chip">
                Total: <span id="totalArticulos">0</span>
              </div>
            </div>

            <div class="table-scroll">
              <table>
                <thead>
                  <tr>
                    <th>ID</th>
                    <th>Código</th>
                    <th>Nombre</th>
                    <th>Precio</th>
                    <th>Exist.</th>
                    <th>Imagen</th>
                    <th>Acciones</th>
                  </tr>
                </thead>
                <tbody id="tbodyArticulos"></tbody>
              </table>
            </div>

            <div id="estadoTablaArticulos" class="empty-state" style="display:none;">
              No se encontraron productos. Agrega uno nuevo o ajusta el filtro de búsqueda.
            </div>
          </section>
        </div>
      </section>

      <!-- VISTA CATEGORÍAS -->
      <section id="view-categorias" class="admin-view hidden">
        <div class="layout">
          <!-- Formulario Categoría -->
          <section class="card">
            <div class="card-header">
              <h2 id="formCategoriaTitulo">Nueva categoría</h2>
              <span class="pill" id="modoCategoriaEtiqueta">Modo creación</span>
            </div>
            <p class="subtext">Crea y organiza las categorías del catálogo.</p>

            <form id="formCategoria" autocomplete="off">
              <label for="catNombre">Nombre de la categoría</label>
              <input
                type="text"
                id="catNombre"
                placeholder="Ej. Juegos PS4"
              />
              <input
                type="hidden"
                id="catSlug"
                placeholder="ej. juegos-ps4"
              />
              
              <label for="catParentId">Categoría padre</label>
              <select id="catParentId" class="select-control">
              <option value="">Sin categoría padre</option>
              </select>

              <div class="form-actions">
                <button type="submit" class="btn btn-primary">
                  <span class="material-symbols-outlined">save</span>
                  <span id="btnCategoriaGuardarTexto">Guardar categoría</span>
                </button>
                <button type="button" class="btn btn-secondary" id="btnCategoriaCancelar">
                  <span class="material-symbols-outlined">keyboard_return</span>
                  Cancelar
                </button>
              </div>
            </form>

            <div id="mensajeCategoria" class="status"></div>
          </section>

          <!-- Tabla Categorías -->
          <section class="card">
            <div class="card-header">
              <h2>Listado de categorías</h2>
            </div>

            <div class="list-header">
              <div class="search-box">
                <span class="material-symbols-outlined">search</span>
                <input
                  type="text"
                  id="buscadorCategorias"
                  placeholder="Buscar por nombre o slug."
                />
              </div>
              <div class="count-chip">
                Total: <span id="totalCategorias">0</span>
              </div>
            </div>

            <div class="table-scroll">
              <table>
                <thead>
                  <tr>
                    <th>Nombre</th>
                    <th>Productos</th>
                    <th>Acciones</th>
                  </tr>
                </thead>
                <tbody id="tbodyCategorias"></tbody>
              </table>
            </div>

            <div id="estadoTablaCategorias" class="empty-state" style="display:none;">
              No se encontraron categorías. Agrega una nueva o ajusta el filtro de búsqueda.
            </div>
          </section>
        </div>
      </section>

      <!-- VISTA BANNERS -->
      <section id="view-banners" class="admin-view hidden">
        <div class="layout">
          <!-- Formulario Banner -->
          <section class="card">
            <div class="card-header">
              <h2 id="formBannerTitulo">Nuevo banner</h2>
              <span class="pill" id="modoBannerEtiqueta">Modo creación</span>
            </div>
            <p class="subtext">Gestiona los banners del carrusel de la tienda.</p>

            <form id="formBanner" autocomplete="off" enctype="multipart/form-data">
              <label for="bannerTitulo">Título (opcional)</label>
              <input type="text" id="bannerTitulo" placeholder="Ej. Ofertas de Temporada" />

              <label for="bannerLink">Link (opcional)</label>
              <input type="url" id="bannerLink" placeholder="https://ejemplo.com" />

              <div class="field-row">
                <div>
                  <label for="bannerOrden">Orden</label>
                  <input type="number" id="bannerOrden" placeholder="0" value="0" />
                </div>
                <div>
                  <label for="bannerActivo">Estado</label>
                  <select id="bannerActivo">
                    <option value="1">Activo</option>
                    <option value="0">Inactivo</option>
                  </select>
                </div>
              </div>

              <label for="bannerImagen">Imagen del banner</label>
              <input type="file" id="bannerImagen" accept="image/*" />
              <p class="input-hint">Tamaño recomendado: 1920x400px. Máximo 5MB.</p>

              <div id="bannerImagenPreview" style="display:none; margin-top:10px;">
                <img id="bannerImagenPreviewImg" src="" alt="Preview" style="max-width:100%; max-height:200px; border-radius:8px;" />
              </div>

              <div class="form-actions">
                <button type="submit" class="btn btn-primary">
                  <span class="material-symbols-outlined">save</span>
                  <span id="btnBannerGuardarTexto">Guardar banner</span>
                </button>
                <button type="button" class="btn btn-secondary" id="btnBannerCancelar">
                  <span class="material-symbols-outlined">keyboard_return</span>
                  Cancelar
                </button>
              </div>
            </form>

            <div id="mensajeBanner" class="status"></div>
          </section>

          <!-- Lista de Banners -->
          <section class="card">
            <div class="card-header">
              <h2>Listado de banners</h2>
            </div>

            <div class="list-header">
              <div class="count-chip">
                Total: <span id="totalBanners">0</span>
              </div>
            </div>

            <div class="table-scroll">
              <table>
                <thead>
                  <tr>
                    <th>Preview</th>
                    <th>Título</th>
                    <th>Orden</th>
                    <th>Estado</th>
                    <th>Acciones</th>
                  </tr>
                </thead>
                <tbody id="tbodyBanners"></tbody>
              </table>
            </div>

            <div id="estadoTablaBanners" class="empty-state" style="display:none;">
              No hay banners registrados. Agrega uno nuevo.
            </div>
          </section>
        </div>
      </section>

      <!-- VISTA PEDIDOS -->
      <section id="view-pedidos" class="admin-view hidden">
        <section class="card">
          <div class="card-header">
            <h2>Pedidos</h2>
          </div>

          <div class="list-header">
            <div class="search-box">
              <span class="material-symbols-outlined">search</span>
              <input
                type="text"
                id="buscarPedidos"
                placeholder="Buscar #pedido o teléfono..."
              />
            </div>

            <div class="filters-row">
              <select id="filtroEstadoPedidos" class="select-control">
                <option value="">Todos los estados</option>
                <option value="pendiente">Pendiente</option>
                <option value="pagado">Pagado</option>
                <option value="enviado">Enviado</option>
                <option value="entregado">Entregado</option>
                <option value="cancelado">Cancelado</option>
              </select>

              <select id="ordenPedidos" class="select-control">
                <option value="fecha-desc">Fecha: recientes</option>
                <option value="fecha-asc">Fecha: antiguos</option>
                <option value="total-desc">Total: mayor a menor</option>
                <option value="total-asc">Total: menor a mayor</option>
              </select>
            </div>
          </div>
          
          <div class="table-scroll">
            <table>
              <thead>
                <tr>
                  <th>ID</th>
                  <th>Cliente</th>
                  <th>Fecha</th>
                  <th>Total</th>
                  <th>Estado</th>
                  <th>Acciones</th>
                </tr>
              </thead>
              <tbody id="cuerpoTablaPedidos">
                <!-- Se cargará dinámicamente -->
              </tbody>
            </table>
          </div>

          <div id="estadoTablaPedidos" class="empty-state" style="display:none;">
            No hay pedidos registrados.
          </div>
        </section>
      </section>

      <!-- Modal detalle pedido -->
      <div id="modalPedido" class="modal hidden">
        <div class="modal-content">
          <div class="modal-header">
            <h3 id="modalPedidoTitulo">Pedido</h3>
            <button id="cerrarModalPedido" class="btn-close-modal">
              <span class="material-symbols-outlined">close</span>
            </button>
          </div>
          <div class="modal-body" id="modalPedidoBody">
            <!-- Contenido dinámico -->
          </div>
          <div class="modal-footer">
            <div style="display: flex; gap: 8px;">
              <button id="btnImprimirPedido" class="btn btn-secondary" title="Imprimir o guardar como PDF">
                <span class="material-symbols-outlined" style="font-size: 18px;">print</span>
              </button>
              <button id="btnDescargarPedido" class="btn btn-secondary" title="Descargar como PDF">
                <span class="material-symbols-outlined" style="font-size: 18px;">download</span>
              </button>
            </div>
            <div style="display: flex; gap: 8px;">
              <button id="btnGuardarEstado" class="btn btn-primary">Guardar cambios</button>
              <button id="btnCerrarModal" class="btn btn-secondary">Cerrar</button>
            </div>
          </div>
        </div>
      </div>

      <!-- VISTA ENVÍOS -->
      <section id="view-envios" class="admin-view hidden">
        <section class="card">
          <div class="card-header">
            <h2>Gestión de envíos</h2>
          </div>
          <p class="subtext">Administra las guías de envío y su estado.</p>

          <div class="list-header">
            <div class="search-box">
              <span class="material-symbols-outlined">search</span>
              <input
                type="text"
                id="buscarEnvios"
                placeholder="Buscar #pedido o guía..."
              />
            </div>

            <div class="filters-row">
              <select id="filtroEstadoEnvios" class="select-control">
                <option value="">Todos los estados</option>
                <option value="pendiente">Pendiente</option>
                <option value="recogido">Recogido</option>
                <option value="en_transito">En tránsito</option>
                <option value="entregado">Entregado</option>
                <option value="incidencia">Incidencia</option>
              </select>

              <select id="filtroCarrier" class="select-control">
                <option value="">Todas las paqueterías</option>
                <option value="DHL">DHL</option>
                <option value="FedEx">FedEx</option>
                <option value="Estafeta">Estafeta</option>
                <option value="Redpack">Redpack</option>
                <option value="99 Minutos">99 Minutos</option>
              </select>
            </div>
          </div>

          <div class="table-scroll">
            <table id="tablaEnvios">
              <thead>
                <tr>
                  <th>Pedido</th>
                  <th>Cliente</th>
                  <th>Total</th>
                  <th>Carrier</th>
                  <th>Guía</th>
                  <th>Estado Envío</th>
                  <th>Estado Pedido</th>
                  <th>Acciones</th>
                </tr>
              </thead>
              <tbody id="tbodyEnvios">
                <!-- Se llena dinámicamente -->
              </tbody>
            </table>
          </div>

          <div id="estadoTablaEnvios" class="empty-state" style="display:none;">
            No hay envíos registrados.
          </div>
        </section>
      </section>

      <!-- Modal editar envío -->
      <div id="modalEditarEnvio" class="modal-overlay" style="display: none;">
        <div class="modal-content" style="max-width: 600px;">
          <div class="modal-header">
            <h3>Editar envío - Pedido #<span id="modalEnvioPedidoId">0</span></h3>
          </div>
          <div class="modal-body">
            <form id="formEditarEnvio" style="display: flex; flex-direction: column; gap: 16px;">
              <div>
                <label for="envioCarrier" style="display: block; margin-bottom: 4px; font-weight: 500;">Carrier / Paquetería</label>
                <select id="envioCarrier" style="width: 100%; padding: 10px; border: 1px solid #ddd; border-radius: 4px; background: rgba(15,23,42,0.9); color: var(--text);" required>
                  <option value="">Seleccionar paquetería</option>
                  <option value="DHL">DHL</option>
                  <option value="FedEx">FedEx</option>
                  <option value="Estafeta">Estafeta</option>
                  <option value="Redpack">Redpack</option>
                  <option value="99 Minutos">99 Minutos</option>
                  <option value="Otro">Otro</option>
                </select>
              </div>

              <div>
                <label for="envioGuia" style="display: block; margin-bottom: 4px; font-weight: 500;">Número de guía</label>
                <div style="display: flex; gap: 8px;">
                  <input type="text" id="envioGuia" placeholder="Ej. 1234567890" style="flex: 1; padding: 10px; border: 1px solid #ddd; border-radius: 4px; background: rgba(15,23,42,0.9); color: var(--text);" required />
                  <button type="button" id="btnCopiarGuia" class="btn btn-secondary" title="Copiar al portapapeles">
                    <span class="material-symbols-outlined" style="font-size: 18px;">content_copy</span>
                  </button>
                </div>
              </div>

              <div>
                <label for="envioEstado" style="display: block; margin-bottom: 4px; font-weight: 500;">Estado del envío</label>
                <select id="envioEstado" style="width: 100%; padding: 10px; border: 1px solid #ddd; border-radius: 4px; background: rgba(15,23,42,0.9); color: var(--text);" required>
                  <option value="pendiente">Pendiente</option>
                  <option value="recogido">Recogido</option>
                  <option value="en_transito">En tránsito</option>
                  <option value="entregado">Entregado</option>
                  <option value="incidencia">Incidencia</option>
                </select>
              </div>

              <div id="linkRastreo" style="display: none; padding: 12px; background: rgba(56,189,248,0.1); border-radius: 8px; border: 1px solid rgba(56,189,248,0.3);">
                <div style="font-size: 0.85rem; color: var(--muted); margin-bottom: 6px;">Link de rastreo:</div>
                <a id="linkRastreoUrl" href="#" target="_blank" style="color: var(--accent); text-decoration: none; word-break: break-all; font-size: 0.9rem;">
                  Ver rastreo →
                </a>
              </div>
            </form>
          </div>
          <div class="modal-footer" style="display: flex; justify-content: flex-end; gap: 8px;">
            <button id="btnGuardarEnvio" class="btn btn-primary">Guardar cambios</button>
            <button id="btnCerrarModalEnvio" class="btn btn-secondary">Cerrar</button>
          </div>
        </div>
      </div>
    </main>
  </div>
  <script src="/js/admin-shell.js"></script>
  <script src="/js/admin-clientes.js"></script>
  <script src="/js/admin-articulos.js"></script>
  <script src="/js/admin-categorias.js"></script>
  <script src="/js/admin-banners.js"></script>
  <script src="/js/admin-pedidos.js"></script>
  <script src="/js/admin-envios.js"></script>
</body>
</html>

